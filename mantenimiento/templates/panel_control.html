{% extends "base.html" %}
{% block title %}
    Panel de Control
{% endblock title %}
{% block content %}
    <div class="d-flex justify-content-center align-items-center mb-4">
        <h1 class="text-center my-0 me-3">Panel de Control</h1>
        <!-- Botón de cerrar sesión con ícono de apagado al lado del título -->
        <button class="btn btn-outline-danger"
                data-bs-toggle="modal"
                data-bs-target="#logoutModal"
                title="Cerrar sesión">
            <i class="bi bi-power"></i>
        </button>
    </div>
    <div class="row">
        <!-- Panel lateral izquierdo -->
        <div class="col-md-3 mb-4">
            <div class="card shadow h-100">
                <div class="card-header bg-warning text-dark">Tareas para Hoy</div>
                <div class="card-body tareas-hoy-scroll">
                    {% if tareas_hoy %}
                        <ul class="list-group list-group-flush">
                            {% for tarea in tareas_hoy %}
                                <li class="list-group-item">
                                    <strong>{{ tarea.id_mantenimiento }}</strong>
                                    <br>
                                    Máquina: {{ tarea.id_maquina }}
                                    <br>
                                    Encargado: {{ tarea.id_encargado }}
                                    <br>
                                    Inicio: {{ tarea.fecha_inicio|date:"H:i" }}
                                    <a href="{% url 'ver-tarea-detalle' tarea.id_tarea %}"
                                       class="btn btn-sm btn-outline-primary mt-1">Ver</a>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted">No hay tareas programadas para hoy.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Panel principal -->
        <div class="col-md-9">
            <div class="dashboard-grid d-grid gap-3 custom-dashboard-grid">
                {% if es_jefe_area %}
                    <a href="{% url 'admin-panel' %}" class="btn btn-light btn-dashboard">
                        <i class="bi bi-person-circle me-2"></i>
                        Opciones de Administrador
                    </a>
                {% endif %}
                <a href="{% url 'ver-maquinas-1' %}"
                   class="btn btn-success btn-dashboard">
                    <i class="bi bi-box-seam me-2"></i>
                    Ver Máquinas
                </a>
                <a href="{% url 'ver-inventario' %}" class="btn btn-info btn-dashboard">
                    <i class="bi bi-clipboard2-data-fill me-2"></i>
                    Ver Inventario
                </a>
                <a href="{% url 'ver-tarea' %}" class="btn btn-danger btn-dashboard">
                    <i class="bi bi-list-check me-2"></i>
                    Ver Tareas
                </a>
                <a href="{% url 'ver-planes-mantenimiento' %}"
                   class="btn btn-dark btn-dashboard">
                    <i class="bi bi-gear-fill me-2"></i>
                    Ver Planes Mantenimientos
                </a>
            </div>
        </div>
    </div>
    <!-- Modal de confirmación para cerrar sesión -->
    <div class="modal fade"
         id="logoutModal"
         tabindex="-1"
         aria-labelledby="logoutModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="logoutModalLabel">Cerrar sesión</h5>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">¿Estás seguro que deseas cerrar sesión?</div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <form method="post" action="{% url 'logout' %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Cerrar sesión</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}
